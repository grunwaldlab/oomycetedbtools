<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Lookup gene sequences from NCBI — get_isolate_seqs • oomycetedbtools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Lookup gene sequences from NCBI — get_isolate_seqs" />
<meta property="og:description" content="Look for sequences of a particular gene for a list of species/isolates/genes from the Genbank
nucleotide database." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">oomycetedbtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/database_format.html">Database format</a>
    </li>
    <li>
      <a href="../articles/update_procedure.html">Database update procedure</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Lookup gene sequences from NCBI</h1>
    
    <div class="hidden name"><code>get_isolate_seqs.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Look for sequences of a particular gene for a list of species/isolates/genes from the Genbank
nucleotide database.</p>
    </div>

    <pre class="usage"><span class='fu'>get_isolate_seqs</span><span class='op'>(</span><span class='va'>species</span>, <span class='va'>genes</span>, isolates <span class='op'>=</span> <span class='cn'>NULL</span>,
  extract_features <span class='op'>=</span> <span class='cn'>FALSE</span>, gene_name_in_feature <span class='op'>=</span> <span class='cn'>TRUE</span>,
  flanking <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, db <span class='op'>=</span> <span class='st'>"nucleotide"</span>, pause <span class='op'>=</span> <span class='fl'>0.5</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>species</th>
      <td><p>The names of species to look up.</p></td>
    </tr>
    <tr>
      <th>genes</th>
      <td><p>The names of the genes to look up.</p></td>
    </tr>
    <tr>
      <th>isolates</th>
      <td><p>The names of isolates to look up. Must be the same length as <code>species</code> if
used.</p></td>
    </tr>
    <tr>
      <th>extract_features</th>
      <td><p>If TRUE, return the sequence for each feature in the sequence annotation
instead of the whole sequence.</p></td>
    </tr>
    <tr>
      <th>gene_name_in_feature</th>
      <td><p>If TRUE, only return features that have one of the gene names
somewhere in their description. Only has an effect if extract_features is TRUE.</p></td>
    </tr>
    <tr>
      <th>flanking</th>
      <td><p>A vector of length 2. The number of base pairs before and after the target gene
to include in the sequence returned. If the flanking sequence is not available, the sequence
will be considered incomplete.</p></td>
    </tr>
    <tr>
      <th>db</th>
      <td><p>The name of the NCBI database to query. Only tested with "nucleotide", but a few others
might work.</p></td>
    </tr>
    <tr>
      <th>pause</th>
      <td><p>The number of seconds to pause between each query. This avoids annoying NCBI and
having them block you IP address. Should be at least 0.35 seconds if you dont have an NCBI API
key and at least 0.1 seconds if you do.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional terms to add to the search request for each species/isolate, see NCBI
documentation for a complete list:
http://www.ncbi.nlm.nih.gov/books/NBK25499/#<em>chapter4_ESearch</em></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A tibble (a type of data.frame) with the following columns, depending on settings:</p><ul>
<li><p>species: The species search term associated with the result</p></li>
<li><p>isolate: The isolate search term associated with the result</p></li>
<li><p>query: The query used to search for sequences on NCBI</p></li>
<li><p>acc: The Genbank accession number</p></li>
<li><p>start: The index of the first base pair of the target gene in the original sequence</p></li>
<li><p>end: The index of the last base pair of the target gene in the original sequence</p></li>
<li><p>feature: The type of locus</p></li>
<li><p>type: The type of annotation for the sequence</p></li>
<li><p>name: The name of the locus</p></li>
<li><p>complete: If the locus was complete in the original sequence, according to the annotation</p></li>
<li><p>seq: The whole sequence the gene was found in</p></li>
<li><p>header: The name of the overall sequence the gene was found in</p></li>
<li><p>length: The length of the whole sequence</p></li>
<li><p>flank_start: The index of the first base pair of the target gene plus the flanking region in the original sequence</p></li>
<li><p>flank_end: The index of the last base pair of the target gene plus the flanking region in the original sequence</p></li>
<li><p>flank_complete: If the locus plus flanking region was complete in the original sequence</p></li>
<li><p>gene_seq: The target gene sequence plus the flanking region</p></li>
<li><p>gene_length: The length of the target gene plus the flanking region</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>

<span class='co'># Search for the whole seqeunces for with P. infestans Cox I</span>
<span class='fu'>get_isolate_seqs</span><span class='op'>(</span>species <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Phytophthora infestans"</span><span class='op'>)</span>,
                 genes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"cox I"</span>, <span class='st'>"cox 1"</span>, <span class='st'>"cox1"</span>, <span class='st'>"coxI"</span>, <span class='st'>"cytochrome oxidase I"</span>, <span class='st'>"cytochrome oxidase 1"</span><span class='op'>)</span>,
                 retmax <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>

<span class='co'># Search for the just the gene sequence for  P. infestans Cox I</span>
<span class='fu'>get_isolate_seqs</span><span class='op'>(</span>species <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Phytophthora infestans"</span><span class='op'>)</span>,
                 genes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"cox I"</span>, <span class='st'>"cox 1"</span>, <span class='st'>"cox1"</span>, <span class='st'>"coxI"</span>, <span class='st'>"cytochrome oxidase I"</span>, <span class='st'>"cytochrome oxidase 1"</span><span class='op'>)</span>,
                 retmax <span class='op'>=</span> <span class='fl'>100</span>,
                 extract_features <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># Search for all the gene sequences in whole sequences that contain P. infestans Cox I</span>
<span class='fu'>get_isolate_seqs</span><span class='op'>(</span>species <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Phytophthora infestans"</span><span class='op'>)</span>,
                 genes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"cox I"</span>, <span class='st'>"cox 1"</span>, <span class='st'>"cox1"</span>, <span class='st'>"coxI"</span>, <span class='st'>"cytochrome oxidase I"</span>, <span class='st'>"cytochrome oxidase 1"</span><span class='op'>)</span>,
                 retmax <span class='op'>=</span> <span class='fl'>100</span>,
                 extract_features <span class='op'>=</span> <span class='cn'>TRUE</span>,
                 gene_name_in_feature <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'># Search for whole sequences for P. infestans Cox I for just some isolates</span>
<span class='fu'>get_isolate_seqs</span><span class='op'>(</span>species <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Phytophthora infestans"</span>, <span class='st'>"Phytophthora infestans"</span>, <span class='st'>"Phytophthora infestans"</span><span class='op'>)</span>,
                 isolates <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"44"</span>, <span class='st'>"580"</span>, <span class='st'>"180"</span><span class='op'>)</span>,
                 genes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"cox I"</span>, <span class='st'>"cox 1"</span>, <span class='st'>"cox1"</span>, <span class='st'>"coxI"</span>, <span class='st'>"cytochrome oxidase I"</span>, <span class='st'>"cytochrome oxidase 1"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Search for just the gene sequences for P. infestans Cox I for just some isolates</span>
<span class='fu'>get_isolate_seqs</span><span class='op'>(</span>species <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Phytophthora infestans"</span>, <span class='st'>"Phytophthora infestans"</span>, <span class='st'>"Phytophthora infestans"</span><span class='op'>)</span>,
                 isolates <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"44"</span>, <span class='st'>"580"</span>, <span class='st'>"180"</span><span class='op'>)</span>,
                 genes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"cox I"</span>, <span class='st'>"cox 1"</span>, <span class='st'>"cox1"</span>, <span class='st'>"coxI"</span>, <span class='st'>"cytochrome oxidase I"</span>, <span class='st'>"cytochrome oxidase 1"</span><span class='op'>)</span>,
                 extract_features <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># Search for P infestans ITS with flanking regions and subset for complete results</span>
<span class='va'>result</span> <span class='op'>&lt;-</span> <span class='fu'>get_isolate_seqs</span><span class='op'>(</span>species <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Phytophthora"</span><span class='op'>)</span>,
                           genes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"internal transcribed spacer"</span><span class='op'>)</span>,
                           retmax <span class='op'>=</span> <span class='fl'>300</span>,
                           extract_features <span class='op'>=</span> <span class='cn'>TRUE</span>,
                           flanking <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>300</span>, <span class='fl'>300</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>result</span><span class='op'>[</span><span class='va'>result</span><span class='op'>$</span><span class='va'>complete</span>, <span class='op'>]</span>
<span class='va'>result</span><span class='op'>[</span><span class='va'>result</span><span class='op'>$</span><span class='va'>flank_complete</span>, <span class='op'>]</span>

<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zachary Foster.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


